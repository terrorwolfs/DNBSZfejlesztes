{"chunk":0,"numChunks":1,"fileHash":"uXWNx46FHnXg9bkxTDgfxgfL2USdgLcuaTrpVXrogfY=","filePath":"FlaskWebProject/WebApp/auth.py","content":"from functools import wraps\nfrom flask import session, redirect, url_for, flash, abort\nfrom .models import User\n\ndef login_required(f):\n    @wraps(f)\n    def decorated_function(*args, **kwargs):\n        if 'user_id' not in session:\n            flash('Please log in to access this page.', 'info')\n            return redirect(url_for('routes.login', next=request.url))\n        return f(*args, **kwargs)\n    return decorated_function\n\ndef admin_required(f):\n    @wraps(f)\n    def decorated_function(*args, **kwargs):\n        if 'user_id' not in session:\n            flash('Please log in to access this page.', 'info')\n            return redirect(url_for('routes.login'))\n        \n        user = User.query.get(session['user_id'])\n        if not user or not user.is_admin:\n            abort(403)\n        return f(*args, **kwargs)\n    return decorated_function\n\ndef get_current_user():\n    if 'user_id' in session:\n        return User.query.get(session['user_id'])\n    return None\n"}